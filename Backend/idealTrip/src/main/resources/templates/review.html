{{>header}}
    <!--banner-slider-->
    <br><br><br><br>
    <section>
        <br><br><br>
        <h5>Añadir comentario
        <button id="review-add-btn" aria-label="add review" title="Add Review"></button></h5>
        <div id="modal" role="dialog" aria-modal="true" aria-labelledby="add-review-header" class="">
            <button class="close-btn" aria-label="close" title="Close">x</button>
            <div id="review-form-container">
                <h2 id="add-review-header">Reseña</h2>
                <form id="review-form">
                    <div class="fieldset">
                        <label for="reviewName">Titulo</label>
                        <input name="reviewName" id="reviewName" required="">
                    </div>
                    <div class="fieldset">
                        <label>Calificación</label>
                        <div class="rate">
                            <input type="radio" id="star5" name="rate" value="5" onkeydown="navRadioGroup(event)"
                                onfocus="setFocus(event)" required="">
                            <label for="star5" title="5 stars">5 stars</label>
                            <input type="radio" id="star4" name="rate" value="4" onkeydown="navRadioGroup(event)">
                            <label for="star4" title="4 stars">4 stars</label>
                            <input type="radio" id="star3" name="rate" value="3" onkeydown="navRadioGroup(event)">
                            <label for="star3" title="3 stars">3 stars</label>
                            <input type="radio" id="star2" name="rate" value="2" onkeydown="navRadioGroup(event)">
                            <label for="star2" title="2 stars">2 stars</label>
                            <input type="radio" id="star1" name="https://codepen.io/pen/rate" value="1"
                                onkeydown="navRadioGroup(event)" onfocus="setFocus(event)">
                            <label for="star1" title="1 star">1 star</label>
                        </div>
                    </div>

                    <div class="fieldset">
                        <label for="reviewComments">Comentarios</label>
                        <textarea name="reviewComments" id="reviewComments" cols="20" rows="5" required=""></textarea>
                    </div>
                    <div class="fieldset right">
                        <button id="submit-review-btn">Publicar</button>
                    </div>
                </form>
            </div>
        </div>
        <div class="modal-overlay"></div>
    </section>

    <script>
        let focusedElementBeforeModal;
        const modal = document.getElementById('modal');
        const modalOverlay = document.querySelector('.modal-overlay');

        window.onload = () => {
            const addReview = document.getElementById('review-add-btn');
            addReview.id = 'review-add-btn';
            addReview.innerHTML = '+';
            addReview.setAttribute('aria-label', 'add review');
            addReview.title = 'Add Review';
            addReview.addEventListener('click', openModal);
            addReview.click();
        }

        const openModal = () => {
            // Save current focus
            focusedElementBeforeModal = document.activeElement;

            // Listen for and trap the keyboard
            modal.addEventListener('keydown', trapTabKey);

            // Listen for indicators to close the modal
            modalOverlay.addEventListener('click', closeModal);
            // Close btn
            const closeBtn = document.querySelector('.close-btn');
            closeBtn.addEventListener('click', closeModal);

            // submit form
            const form = document.getElementById('review-form');
            form.addEventListener('submit', submitAddReview, false);

            // Find all focusable children
            var focusableElementsString = 'a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, [tabindex="0"], [contenteditable]';
            var focusableElements = modal.querySelectorAll(focusableElementsString);
            // Convert NodeList to Array
            focusableElements = Array.prototype.slice.call(focusableElements);

            var firstTabStop = focusableElements[0];
            var lastTabStop = focusableElements[focusableElements.length - 1];

            // Show the modal and overlay
            modal.classList.add('show');
            modalOverlay.classList.add('show');

            // Focus first child
            // firstTabStop.focus();
            const reviewName = document.getElementById('reviewName');
            reviewName.focus();

            function trapTabKey(e) {
                // Check for TAB key press
                if (e.keyCode === 9) {

                    // SHIFT + TAB
                    if (e.shiftKey) {
                        if (document.activeElement === firstTabStop) {
                            e.preventDefault();
                            lastTabStop.focus();
                        }

                        // TAB
                    } else {
                        if (document.activeElement === lastTabStop) {
                            e.preventDefault();
                            firstTabStop.focus();
                        }
                    }
                }

                // ESCAPE
                if (e.keyCode === 27) {
                    closeModal();
                }
            }
        };

        const submitAddReview = (e) => {
            // console.log(e);
            console.log('Form subbmitted!');
            e.preventDefault();
            closeModal();
        };

        const closeModal = () => {
            // Hide the modal and overlay
            modal.classList.remove('show');
            modalOverlay.classList.remove('show');

            const form = document.getElementById('review-form');
            form.reset();
            // Set focus back to element that had it before the modal was opened
            focusedElementBeforeModal.focus();
        };

        const setFocus = (evt) => {
            const rateRadios = document.getElementsByName('rate');
            const rateRadiosArr = Array.from(rateRadios);
            const anyChecked = rateRadiosArr.some(radio => { return radio.checked === true; });
            // console.log('anyChecked', anyChecked);
            if (!anyChecked) {
                const star1 = document.getElementById('star1');
                star1.focus();
                // star1.checked = true;
            }
        };

        const navRadioGroup = (evt) => {
            // console.log('key', evt.key, 'code', evt.code, 'which', evt.which);
            // console.log(evt);

            const star1 = document.getElementById('star1');
            const star2 = document.getElementById('star2');
            const star3 = document.getElementById('star3');
            const star4 = document.getElementById('star4');
            const star5 = document.getElementById('star5');

            if (['ArrowRight', 'ArrowLeft', 'ArrowDown', 'ArrowUp'].includes(evt.key)) {
                evt.preventDefault();
                // console.log('attempting return');
                if (evt.key === 'ArrowRight' || evt.key === 'ArrowDown') {
                    switch (evt.target.id) {
                        case 'star1':
                            star2.focus();
                            star2.checked = true;
                            break;
                        case 'star2':
                            star3.focus();
                            star3.checked = true;
                            break;
                        case 'star3':
                            star4.focus();
                            star4.checked = true;
                            break;
                        case 'star4':
                            star5.focus();
                            star5.checked = true;
                            break;
                        case 'star5':
                            star1.focus();
                            star1.checked = true;
                            break;
                    }
                } else if (evt.key === 'ArrowLeft' || evt.key === 'ArrowUp') {
                    switch (evt.target.id) {
                        case 'star1':
                            star5.focus();
                            star5.checked = true;
                            break;
                        case 'star2':
                            star1.focus();
                            star1.checked = true;
                            break;
                        case 'star3':
                            star2.focus();
                            star2.checked = true;
                            break;
                        case 'star4':
                            star3.focus();
                            star3.checked = true;
                            break;
                        case 'star5':
                            star4.focus();
                            star4.checked = true;
                            break;
                    }
                }
            }
        };
    </script>

    <!-- testimonials -->
    <section class="w3l-clients" id="clients">
        <!-- /grids -->
        <div class="cusrtomer-layout py-5">
            <div class="container py-lg-4 py-md-3 pb-lg-0">
                <div class="heading text-center mx-auto">
                    <h3 class="hny-title mb-md-5 mb-4">Lo que nuestros clientes dicen</h3>
                </div>
                <div class="review-list">
                    {{#reviews}}
                    <div class="review-box">
                      <div class="review-rating">{{ratingReview}}</div>
                      <div class="review-contentbox">
                        <h3 class="review-title">{{titleReview}}</h3>
                        <p class="review-content">{{contentReview}}</p>
                      </div>
                    </div>
                    {{/reviews}}
                  </div>
                <!-- /grids -->
                <div class="testimonial-width">
                    <div id="owl-demo1" class="owl-two owl-carousel owl-theme">
                        <div class="item">
                            <div class="testimonial-content">
                                <div class="testimonial">
                                    <blockquote>
                                        <span class="fa fa-quote-left" aria-hidden="true"></span>
                                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Velit beatae laudantium
                                        voluptate rem ullam dolore nisi voluptatibus esse quasi. Integer sit amet .Lorem
                                        ipsum dolor sit
                                        amet adipisicing elit. Laborum dolor facere ipsum adipisicingelit.
                                    </blockquote>
                                    <div class="testi-des">
                                        <div class="test-img"><img src="assets/images/c1.jpg" class="img-fluid"
                                                alt="client-img">
                                        </div>
                                        <div class="peopl align-self">
                                            <h3>Rohit Paul</h3>
                                            <p class="indentity">Example City</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="testimonial-content">
                                <div class="testimonial">
                                    <blockquote>
                                        <span class="fa fa-quote-left" aria-hidden="true"></span>
                                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Velit beatae laudantium
                                        voluptate rem ullam dolore nisi voluptatibus esse quasi. Integer sit amet .Lorem
                                        ipsum dolor sit
                                        amet adipisicing elit. Laborum dolor facere ipsum adipisicingelit.
                                    </blockquote>
                                    <div class="testi-des">
                                        <div class="test-img"><img src="assets/images/c2.jpg" class="img-fluid"
                                                alt="client-img">
                                        </div>
                                        <div class="peopl align-self">
                                            <h3>Shveta</h3>
                                            <p class="indentity">Example City</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="testimonial-content">
                                <div class="testimonial">
                                    <blockquote>
                                        <span class="fa fa-quote-left" aria-hidden="true"></span>
                                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Velit beatae laudantium
                                        voluptate rem ullam dolore nisi voluptatibus esse quasi. Integer sit amet .Lorem
                                        ipsum dolor sit
                                        amet adipisicing elit. Laborum dolor facere ipsum adipisicingelit.
                                    </blockquote>
                                    <div class="testi-des">
                                        <div class="test-img"><img src="assets/images/c3.jpg" class="img-fluid"
                                                alt="client-img">
                                        </div>
                                        <div class="peopl align-self">
                                            <h3>Roy Linderson</h3>
                                            <p class="indentity">Example City</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="item">
                            <div class="testimonial-content">
                                <div class="testimonial">
                                    <blockquote>
                                        <span class="fa fa-quote-left" aria-hidden="true"></span>
                                        Lorem ipsum dolor sit amet consectetur adipisicing elit. Velit beatae laudantium
                                        voluptate rem ullam dolore nisi voluptatibus esse quasi. Integer sit amet .Lorem
                                        ipsum dolor sit
                                        amet adipisicing elit. Laborum dolor facere ipsum adipisicingelit.
                                    </blockquote>
                                    <div class="testi-des">
                                        <div class="test-img"><img src="assets/images/c4.jpg" class="img-fluid"
                                                alt="client-img">
                                        </div>
                                        <div class="peopl align-self">
                                            <h3>Mike Thyson</h3>
                                            <p class="indentity">Example City</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            </div>
            <!-- /grids -->
        </div>
        <!-- //grids -->
    </section>
    <!-- //testimonials -->

    {{>footer}}

</html>